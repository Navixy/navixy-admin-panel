(function(e){if(e.fn.inputmask==undefined){e.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:e.noop,onincomplete:e.noop,oncleared:e.noop,repeat:0,greedy:true,autoUnmask:false,clearMaskOnLostFocus:true,insertMode:true,clearIncomplete:false,aliases:{},onKeyUp:e.noop,onKeyDown:e.noop,showMaskOnHover:true,numericInput:false,radixPoint:".",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-zА-яЁё]",cardinality:1},"*":{validator:"[A-Za-zА-яЁё0-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,16,17,18,20,27,33,34,35,36,37,38,39,40,46,91,93,108]},val:e.fn.val};e.fn.inputmask=function(t,n){function h(e){var t=document.createElement("input"),e="on"+e,n=e in t;if(!n){t.setAttribute(e,"return;");n=typeof t[e]=="function"}t=null;return n}function p(t){var i=r.aliases[t];if(i){if(i.alias)p(i.alias);e.extend(true,r,i);e.extend(true,r,n);return true}return false}function d(){var t=false,n=0;if(r.mask.length==1&&r.greedy==false){r.placeholder=""}var i=e.map(r.mask.split(""),function(e,i){var s=[];if(e==r.escapeChar){t=true}else if(e!=r.optionalmarker.start&&e!=r.optionalmarker.end||t){var o=r.definitions[e];if(o&&!t){for(var u=0;u<o.cardinality;u++){s.push(b(n+u))}}else{s.push(e);t=false}n+=s.length;return s}});var s=i.slice();for(var o=1;o<r.repeat&&r.greedy;o++){s=s.concat(i.slice())}return s}function v(){var t=false,n=false;var i=false;return e.map(r.mask.split(""),function(e,s){var o=[];if(e==r.escapeChar){n=true}else if(e==r.optionalmarker.start&&!n){t=true;i=true}else if(e==r.optionalmarker.end&&!n){t=false;i=true}else{var u=r.definitions[e];if(u&&!n){var a=u["prevalidator"],f=a?a.length:0;for(var l=1;l<u.cardinality;l++){var c=f>=l?a[l-1]:[],h=c["validator"],p=c["cardinality"];o.push({fn:h?typeof h=="string"?new RegExp(h):new function(){this.test=h}:new RegExp("."),cardinality:p?p:1,optionality:t,newBlockMarker:t==true?i:false,offset:0,casing:u["casing"],def:e});if(t==true)i=false}o.push({fn:u.validator?typeof u.validator=="string"?new RegExp(u.validator):new function(){this.test=u.validator}:new RegExp("."),cardinality:u.cardinality,optionality:t,newBlockMarker:i,offset:0,casing:u["casing"],def:e})}else{o.push({fn:null,cardinality:0,optionality:t,newBlockMarker:i,offset:0,casing:null,def:e});n=false}i=false;return o}})}function m(e,t,n,i){if(e<0||e>=w())return false;var s=y(e),o=t?1:0,u="";for(var a=c[s].cardinality;a>o;a--){u+=T(n,s-(a-1))}if(t){u+=t}return c[s].fn!=null?c[s].fn.test(u,n,e,i,r):false}function g(e){var t=y(e);var n=c[t];return n!=undefined?n.fn:false}function y(e){return e%c.length}function b(e){return r.placeholder.charAt(e%r.placeholder.length)}function w(){var e=l.length;if(!r.greedy&&r.repeat>1){e+=l.length*(r.repeat-1)}return e}function E(e,t){var n=w();if(t>=n)return n;var r=t;while(++r<n&&!g(r)){}return r}function S(e,t){var n=t;if(n<=0)return 0;while(--n>0&&!g(n)){}return n}function x(e,t,n){var r=c[y(t)];var i=n;if(i!=undefined){switch(r.casing){case"upper":i=n.toUpperCase();break;case"lower":i=n.toLowerCase();break}}e[t]=i}function T(e,t,n){if(n)t=N(e,t);return e[t]}function N(e,t,n){var r;if(n){while(t<0&&e.length<w()){r=l.length-1;t=l.length;while(l[r]!==undefined){e.unshift(l[r--])}}}else{while(e[t]==undefined&&e.length<w()){r=0;while(l[r]!==undefined){e.push(l[r++])}}}return t}function C(e,t,n){e._valueSet(t.join(""));if(n!=undefined){if(o){setTimeout(function(){P(e,n)},100)}else P(e,n)}}function k(e,t,n){for(var r=t,i=w();r<n&&r<i;r++){x(e,r,T(l.slice(),r))}}function L(e,t){var n=y(t);x(e,t,T(l,n))}function A(t,n,i,s){var o=e(t).data("inputmask")["isRTL"],u=M(t._valueGet(),o).split("");if(o){var a=w();var f=u.reverse();f.length=a;for(var h=0;h<a;h++){var p=y(a-(h+1));if(c[p].fn==null&&f[h]!=T(l,p)){f.splice(h,0,T(l,p));f.length=a}else{f[h]=f[h]||T(l,p)}}u=f.reverse()}k(n,0,n.length);n.length=l.length;var d=-1,v=-1,S,a=w(),N=u.length,A=N==0?a:-1;for(var h=0;h<N;h++){for(var O=v+1;O<a;O++){if(g(O)){var _=u[h];if((S=m(O,_,n,!i))!==false){if(S!==true){O=S.pos||O;_=S.c||_}x(n,O,_);d=v=O}else{L(n,O);if(_==b(O)){v=O;A=O}}break}else{L(n,O);if(d==v)d=O;v=O;if(u[h]==T(n,O))break}}}if(r.greedy==false){var D=M(n.join(""),o).split("");while(n.length!=D.length){o?n.shift():n.pop()}}if(i){C(t,n)}return o?r.numericInput?e.inArray(r.radixPoint,n)!=-1&&s!==true?e.inArray(r.radixPoint,n):E(n,a):E(n,A):E(n,d)}function O(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];return e.replace(new RegExp("(\\"+t.join("|\\")+")","gim"),"\\$1")}function M(e,t){return t?e.replace(new RegExp("^("+O(l.join(""))+")*"),""):e.replace(new RegExp("("+O(l.join(""))+")*$"),"")}function _(t,n){A(t,n,false);var r=n.slice();if(e(t).data("inputmask")["isRTL"]){for(var i=0;i<=r.length-1;i++){var s=y(i);if(c[s].optionality){if(b(i)==n[i]||!g(i))r.splice(0,1);else break}else break}}else{for(var i=r.length-1;i>=0;i--){var s=y(i);if(c[s].optionality){if(b(i)==n[i]||!g(i))r.pop();else break}else break}}C(t,r)}function D(t,n){var r=t[0];if(c&&(n===true||!t.hasClass("hasDatepicker"))){var i=l.slice();A(r,i);return e.map(i,function(e,t){return g(t)&&e!=T(l.slice(),t)?e:null}).join("")}else{return r._valueGet()}}function P(e,t,n){var i=e.jquery&&e.length>0?e[0]:e;if(typeof t=="number"){n=typeof n=="number"?n:t;if(r.insertMode==false&&t==n)n++;if(i.setSelectionRange){i.setSelectionRange(t,n)}else if(i.createTextRange){var s=i.createTextRange();s.collapse(true);s.moveEnd("character",n);s.moveStart("character",t);s.select()}i.focus();if(o&&n!=i.selectionEnd)a={begin:t,end:n}}else{var u=o?a:null,a=null;if(u==null){if(i.setSelectionRange){t=i.selectionStart;n=i.selectionEnd}else if(document.selection&&document.selection.createRange){var s=document.selection.createRange();t=0-s.duplicate().moveStart("character",-1e5);n=t+s.text.length}u={begin:t,end:n}}return u}}function H(t){function F(e){var t=true,n=e._valueGet(),r=n.length;for(var i=0;i<r;i++){if(g(i)&&n.charAt(i)==b(i)){t=false;break}}return t}function I(t){var n=e._data(t).events;e.each(n,function(n,r){e(t).bind(n+".inputmask",function(e){if(this.readOnly||this.disabled){e.stopPropagation();e.stopImmediatePropagation();e.preventDefault();return false}});var i=r[r.length-1];for(var s=r.length-1;s>0;s--){r[s]=r[s-1]}r[0]=i})}function q(t){var n;if(Object.getOwnPropertyDescriptor)n=Object.getOwnPropertyDescriptor(t,"value");if(n&&n.get){if(!t._valueGet){t._valueGet=n.get;t._valueSet=n.set;Object.defineProperty(t,"value",{get:function(){var t=e(this),n=e(this).data("inputmask");return n&&n["autoUnmask"]?t.inputmask("unmaskedvalue"):this._valueGet()!=n["_buffer"].join("")?this._valueGet():""},set:function(t){this._valueSet(t);e(this).triggerHandler("setvalue.inputmask")}})}}else if(document.__lookupGetter__&&t.__lookupGetter__("value")){if(!t._valueGet){t._valueGet=t.__lookupGetter__("value");t._valueSet=t.__lookupSetter__("value");t.__defineGetter__("value",function(){var t=e(this),n=e(this).data("inputmask");return n&&n["autoUnmask"]?t.inputmask("unmaskedvalue"):this._valueGet()!=n["_buffer"].join("")?this._valueGet():""});t.__defineSetter__("value",function(t){this._valueSet(t);e(this).triggerHandler("setvalue.inputmask")})}}else{if(!t._valueGet){t._valueGet=function(){return this.value};t._valueSet=function(e){this.value=e}}if(e.fn.val.inputmaskpatch!=true){e.fn.val=function(){if(arguments.length==0){var t=e(this);if(t.data("inputmask")){if(t.data("inputmask")["autoUnmask"])return t.inputmask("unmaskedvalue");else{var n=e.inputmask.val.apply(t);return n!=t.data("inputmask")["_buffer"].join("")?n:""}}else return e.inputmask.val.apply(t)}else{var r=arguments;return this.each(function(){var t=e(this);var n=e.inputmask.val.apply(t,r);if(t.data("inputmask"))t.triggerHandler("setvalue.inputmask");return n})}};e.extend(e.fn.val,{inputmaskpatch:true})}}}function R(e,t,n){while(!g(e)&&e-1>=0)e--;for(var r=e;r<t&&r<w();r++){if(g(r)){L(a,r);var i=E(a,r);var s=T(a,i);if(s!=b(i)){if(i<w()&&m(r,s,a,true)!==false&&c[y(r)].def==c[y(i)].def){x(a,r,T(a,i));L(a,i)}else{if(g(r))break}}else if(n==undefined)break}else{L(a,r)}}if(n!=undefined)x(a,D?t:S(a,t),n);a=M(a.join(""),D).split("");if(a.length==0)a=l.slice();return e}function U(e,t,n,r){for(var i=e;i<=t&&i<w();i++){if(g(i)){var s=T(a,i);x(a,i,n);if(s!=b(i)){var o=E(a,i);if(o<w()){if(m(o,s,a,true)!==false&&c[y(i)].def==c[y(o)].def)n=s;else{if(g(o))break;else n=s}}else break}else if(r!==true)break}else L(a,i)}var u=a.length;a=M(a.join(""),D).split("");if(a.length==0)a=l.slice();return t-(u-a.length)}function z(t){h=false;var n=this,i=t.keyCode,o=P(n);if(r.numericInput){var u=n._valueGet();var c=u.indexOf(r.radixPoint);if(c!=-1){D=o.begin<=c||o.end<=c}}if(i==r.keyCode.BACKSPACE||i==r.keyCode.DELETE||s&&i==127){var d=w();if(o.begin==0&&o.end==d){a=l.slice();C(n,a);P(n,A(n,a,false))}else if(o.end-o.begin>1||o.end-o.begin==1&&r.insertMode){k(a,o.begin,o.end);C(n,a,D?A(n,a,false):o.begin)}else{var m=o.begin-(i==r.keyCode.DELETE?0:1);if(m<v&&i==r.keyCode.DELETE){m=v}if(m>=v){if(r.numericInput&&r.greedy&&i==r.keyCode.DELETE&&a[m]==r.radixPoint){m=E(a,m);D=false}if(D){m=U(v,m,b(m),true);m=r.numericInput&&r.greedy&&i==r.keyCode.BACKSPACE&&a[m+1]==r.radixPoint?m+1:E(a,m)}else m=R(m,d);C(n,a,m)}}if(n._valueGet()==l.join(""))e(n).trigger("cleared");return false}else if(i==r.keyCode.END||i==r.keyCode.PAGE_DOWN){setTimeout(function(){var e=A(n,a,false,true);if(!r.insertMode&&e==w()&&!t.shiftKey)e--;P(n,t.shiftKey?o.begin:e,e)},0);return false}else if(i==r.keyCode.HOME||i==r.keyCode.PAGE_UP){P(n,0,t.shiftKey?o.begin:0);return false}else if(i==r.keyCode.ESCAPE){n._valueSet(f);P(n,0,A(n,a));return false}else if(i==r.keyCode.INSERT){r.insertMode=!r.insertMode;P(n,!r.insertMode&&o.begin==w()?o.begin-1:o.begin);return false}else if(t.ctrlKey&&i==88){setTimeout(function(){P(n,A(n,a,true))},0)}else if(!r.insertMode){if(i==r.keyCode.RIGHT){var g=o.begin==o.end?o.end+1:o.end;g=g<w()?g:o.end;P(n,t.shiftKey?o.begin:g,t.shiftKey?g+1:g);return false}else if(i==r.keyCode.LEFT){var g=o.begin-1;g=g>0?g:0;P(n,g,t.shiftKey?o.end:g);return false}}r.onKeyDown.call(this,t,r);p=e.inArray(i,r.ignorables)!=-1}function W(t){if(h)return false;h=true;var n=this,i=e(n);t=t||window.event;var s=t.which||t.charCode||t.keyCode;if(r.numericInput&&s==r.radixPoint.charCodeAt(r.radixPoint.length-1)){var u=n._valueGet();var f=u.indexOf(r.radixPoint);P(n,E(a,f!=-1?f:w()))}if(t.ctrlKey||t.altKey||t.metaKey||p){return true}else{if(s){i.trigger("input");var l=P(n),c=String.fromCharCode(s),d=w();k(a,l.begin,l.end);if(D){var g=r.numericInput?l.end:S(a,l.end),y;if((y=m(g==d||T(a,g)==r.radixPoint?S(a,g):g,c,a,false))!==false){if(y!==true){g=y.pos||l;c=y.c||c}var L=v;if(r.insertMode==true){if(r.greedy==true){var A=a.slice();while(T(A,L,true)!=b(L)&&L<=g){L=L==d?d+1:E(a,L)}}if(L<=g&&(r.greedy||a.length<d)){if(a[v]!=b(v)&&a.length<d){var O=N(a,-1,D);if(l.end!=0)g=g+O;d=a.length}R(L,r.numericInput?S(a,g):g,c)}else return false}else x(a,r.numericInput?S(a,g):g,c);C(n,a,r.numericInput&&g==0?E(a,g):g);setTimeout(function(){if(F(n))i.trigger("complete")},0)}else if(o)C(n,a,l.begin)}else{var g=E(a,l.begin-1),y;N(a,g,D);if((y=m(g,c,a,false))!==false){if(y!==true){g=y.pos||g;c=y.c||c}if(r.insertMode==true){var M=w();var A=a.slice();while(T(A,M,true)!=b(M)&&M>=g){M=M==0?-1:S(a,M)}if(M>=g)U(g,a.length,c);else return false}else x(a,g,c);var _=E(a,g);C(n,a,_);setTimeout(function(){if(F(n))i.trigger("complete")},0)}else if(o)C(n,a,l.begin)}return false}}}function X(t){var n=e(this),i=this;var s=t.keyCode;r.onKeyUp.call(this,t,r);if(s==r.keyCode.TAB&&n.hasClass("focus.inputmask")&&i._valueGet().length==0){a=l.slice();C(i,a);if(!D)P(i,0);f=i._valueGet()}}var n=e(t);if(!n.is(":input"))return;r.greedy=r.greedy?r.greedy:r.repeat==0;var u=n.prop("maxLength");if(w()>u&&u>-1){if(u<l.length)l.length=u;if(r.greedy==false){r.repeat=Math.round(u/l.length)}}n.prop("maxLength",w()*2);n.data("inputmask",{tests:c,_buffer:l,greedy:r.greedy,repeat:r.repeat,autoUnmask:r.autoUnmask,definitions:r.definitions,isRTL:false});q(t);var a=l.slice(),f=t._valueGet(),h=false,p=false,d=-1,v=E(a,-1),O=S(a,w()),D=false;if(t.dir=="rtl"||r.numericInput){t.dir="ltr";n.css("text-align","right");n.removeAttr("dir");var H=n.data("inputmask");H["isRTL"]=true;n.data("inputmask",H);D=true}n.unbind(".inputmask");n.removeClass("focus.inputmask");n.bind("mouseenter.inputmask",function(){var t=e(this),n=this;if(!t.hasClass("focus.inputmask")&&r.showMaskOnHover){var i=n._valueGet().length;if(i<a.length){if(i==0)a=l.slice();C(n,a)}}}).bind("blur.inputmask",function(){var t=e(this),n=this,i=n._valueGet();t.removeClass("focus.inputmask");if(i!=f){t.change()}if(r.clearMaskOnLostFocus){if(i==l.join(""))n._valueSet("");else{_(n,a)}}if(!F(n)){t.trigger("incomplete");if(r.clearIncomplete){if(r.clearMaskOnLostFocus)n._valueSet("");else{a=l.slice();C(n,a)}}}}).bind("focus.inputmask",function(){var t=e(this),n=this;if(!t.hasClass("focus.inputmask")&&!r.showMaskOnHover){var i=n._valueGet().length;if(i<a.length){if(i==0)a=l.slice();P(n,A(n,a,true))}}t.addClass("focus.inputmask");f=n._valueGet()}).bind("mouseleave.inputmask",function(){var t=e(this),n=this;if(r.clearMaskOnLostFocus){if(!t.hasClass("focus.inputmask")){if(n._valueGet()==l.join("")||n._valueGet()=="")n._valueSet("");else{_(n,a)}}}}).bind("click.inputmask",function(){var e=this;setTimeout(function(){var t=P(e);if(t.begin==t.end){var n=t.begin;d=A(e,a,false);if(D)P(e,n>d&&(m(n,a[n],a,true)!==false||!g(n))?n:d);else P(e,n<d&&(m(n,a[n],a,true)!==false||!g(n))?n:d)}},0)}).bind("dblclick.inputmask",function(){var e=this;setTimeout(function(){P(e,0,d)},0)}).bind("keydown.inputmask",z).bind("keypress.inputmask",W).bind("keyup.inputmask",X).bind(i+".inputmask, dragdrop.inputmask, drop.inputmask",function(){var e=this;setTimeout(function(){P(e,A(e,a,true))},0)}).bind("setvalue.inputmask",function(){var e=this;f=e._valueGet();A(e,a,true);if(e._valueGet()==l.join(""))e._valueSet("")}).bind("complete.inputmask",r.oncomplete).bind("incomplete.inputmask",r.onincomplete).bind("cleared.inputmask",r.oncleared);d=A(t,a,true);var B;try{B=document.activeElement}catch(j){}if(B===t){n.addClass("focus.inputmask");P(t,d)}else if(r.clearMaskOnLostFocus){if(t._valueGet()==l.join("")){t._valueSet("")}else{_(t,a)}}I(t);}var r=e.extend(true,{},e.inputmask.defaults,n);var i=h("paste")?"paste":"input";var s=navigator.userAgent.match(/iphone/i)!=null;var o=navigator.userAgent.match(/android.*mobile safari.*/i)!=null;if(o){var u=navigator.userAgent.match(/mobile safari.*/i);var a=parseInt((new RegExp(/[0-9]+/)).exec(u));o=a<=533}var f=null;if(typeof t=="string"){switch(t){case"mask":var l=d();var c=v();return this.each(function(){H(this)});break;case"unmaskedvalue":var c=this.data("inputmask")["tests"];var l=this.data("inputmask")["_buffer"];r.greedy=this.data("inputmask")["greedy"];r.repeat=this.data("inputmask")["repeat"];r.definitions=this.data("inputmask")["definitions"];return D(this);break;case"remove":var c,l;return this.each(function(){var t=e(this),n=this;setTimeout(function(){if(t.data("inputmask")){c=t.data("inputmask")["tests"];l=t.data("inputmask")["_buffer"];r.greedy=t.data("inputmask")["greedy"];r.repeat=t.data("inputmask")["repeat"];r.definitions=t.data("inputmask")["definitions"];n._valueSet(D(t,true));t.removeData("inputmask");t.unbind(".inputmask");t.removeClass("focus.inputmask");var e;if(Object.getOwnPropertyDescriptor)e=Object.getOwnPropertyDescriptor(n,"value");if(e&&e.get){if(n._valueGet){Object.defineProperty(n,"value",{get:n._valueGet,set:n._valueSet})}}else if(document.__lookupGetter__&&n.__lookupGetter__("value")){if(n._valueGet){n.__defineGetter__("value",n._valueGet);n.__defineSetter__("value",n._valueSet)}}delete n._valueGet;delete n._valueSet}},0)});break;case"getemptymask":if(this.data("inputmask"))return this.data("inputmask")["_buffer"].join("");else return"";case"hasMaskedValue":return this.data("inputmask")?!this.data("inputmask")["autoUnmask"]:false;default:if(!p(t)){r.mask=t}var l=d();var c=v();return this.each(function(){H(this)});break}}if(typeof t=="object"){r=e.extend(true,{},e.inputmask.defaults,t);p(r.alias);var l=d();var c=v();return this.each(function(){H(this)})}}}})(jQuery);